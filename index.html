<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–£–∫—Ä–∞—ó–Ω—Å—å–∫—ñ –ø–µ—Ä–µ–∫–ª–∞–¥–∏ –º–æ–¥—ñ–≤</title>
  <link rel="icon" href="data:,">
  <style>
    :root {
      --bg: #f4f4f4;
      --text: #333;
      --card-bg: #fff;
    }
    body.dark {
      --bg: #1e1e1e;
      --text: #f1f1f1;
      --card-bg: #2b2b2b;
    }
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0 0 60px;
      background-color: var(--bg);
      color: var(--text);
      transition: background 0.3s, color 0.3s;
    }
    header {
      position: sticky;
      top: 0;
      z-index: 1000;
      background: var(--bg);
      padding: 10px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
    }
    h1 {
      width: 100%;
      text-align: center;
      margin: 10px 0;
    }
    input, select {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 14px;
    }
    .mod-list {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      padding: 20px;
      gap: 15px;
    }
    .mod-card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 15px;
      width: 240px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      transition: transform 0.2s, opacity 0.3s;
      animation: fadeIn 0.4s ease;
    }
    .mod-card.hidden {
      display: none;
    }
    .mod-card:hover {
      transform: translateY(-5px);
    }
    .mod-card img {
      width: 70%;
      display: block;
      margin: 0 auto;
      border-radius: 8px;
    }
    button {
      background: #4CAF50;
      border: none;
      color: #fff;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 8px;
      transition: background 0.2s;
    }
    button:hover {
      background: #3c9642;
    }
    #theme-toggle {
      background: #444;
    }
    #theme-toggle:hover {
      background: #222;
    }
    footer {
      position: fixed;
      bottom: 5px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 12px;
      opacity: 0.6;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <header>
    <h1>üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫—ñ –ø–µ—Ä–µ–∫–ª–∞–¥–∏ –º–æ–¥—ñ–≤</h1>
    <input type="text" id="search" placeholder="–ü–æ—à—É–∫ –ø–æ –Ω–∞–∑–≤—ñ...">
    <select id="version-filter"><option value="">–í–µ—Ä—Å—ñ—è MC</option></select>
    <select id="loader-filter"><option value="">–õ–æ–∞–¥–µ—Ä</option></select>
    <select id="author-filter"><option value="">–ê–≤—Ç–æ—Ä</option></select>
    <button id="theme-toggle">üåô</button>
  </header>

  <div class="mod-list" id="mod-list"></div>

  <footer>
    —á–∞—Å –≤—ñ–¥—á–∞—Å—É –∑ º—è–≤–ª—è—î—Ç—å—Å—è –Ω–æ–≤–∏–π –ø–µ—Ä–µ–∫–ª–∞–¥, –∞–ª–µ –¥–ª—è —Ç–æ–≥–æ —â–æ–± –≤—ñ–Ω —É –≤–∞—Å –ø–æ—è–≤–∏–≤—Å—è –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å Ctrl + F5
  </footer>

  <script>
    const repoOwner = "halitflyn";
    const repoName = "ua";
    const basePath = "mods";
    const rawBaseUrl = `https://raw.githubusercontent.com/${repoOwner}/${repoName}/main`;

    async function fetchRepoContents(path) {
      const url = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${path}`;
      const res = await fetch(url);
      if (!res.ok) return null;
      return await res.json();
    }

    async function loadMods() {
      const mods = await fetchRepoContents(basePath);
      if (!mods) return;
      const modList = document.getElementById("mod-list");
      const versionSet = new Set(), loaderSet = new Set(), authorSet = new Set();

      for (const mod of mods) {
        if (mod.type !== "dir") continue;
        const modPath = `${basePath}/${mod.name}`;
        const contents = await fetchRepoContents(modPath);
        if (!contents) continue;

        let modJson=null, modTxt=null, imageUrl=null, langFiles=[];
        for (const file of contents) {
          if (file.name === "mod.json") {
            const res = await fetch(`${rawBaseUrl}/${modPath}/mod.json`);
            modJson = res.ok ? await res.json() : null;
          } else if (file.name === "mod.txt") {
            const res = await fetch(`${rawBaseUrl}/${modPath}/mod.txt`);
            modTxt = res.ok ? await res.text() : null;
          } else if (file.name === "image.jpeg") {
            imageUrl = `${rawBaseUrl}/${modPath}/image.jpeg`;
          } else if (file.name.toLowerCase() === "lang") {
            const langs = await fetchRepoContents(`${modPath}/lang`);
            if (langs) {
              langFiles = langs.map(l => ({
                author: l.name.replace(".json",""),
                url: `${rawBaseUrl}/${modPath}/lang/${l.name}`
              }));
            }
          }
        }
        if (!modJson || !modTxt) continue;
        const [name, description] = modTxt.trim().split("\n");

        modJson.forEach(v=>{
          versionSet.add(v.version);
          loaderSet.add(v.loader);
          authorSet.add(v.author);
        });

        const card = document.createElement("div");
        card.className = "mod-card";
        card.dataset.name = name.toLowerCase();
        card.dataset.versions = modJson.map(v=>v.version).join(",");
        card.dataset.loaders = modJson.map(v=>v.loader).join(",");
        card.dataset.authors = modJson.map(v=>v.author.toLowerCase()).join(",");

        card.innerHTML = `
          <img src="${imageUrl}" alt="${name}">
          <h2>${name}</h2>
          <p>${description}</p>
          <button onclick='alert("–¢—É—Ç –º–æ–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç–∏ –≤–∏–±—ñ—Ä –ø–µ—Ä–µ–∫–ª–∞–¥—É")'>–í–∏–±—Ä–∞—Ç–∏ –ø–µ—Ä–µ–∫–ª–∞–¥</button>
        `;
        modList.appendChild(card);
      }
      fillSelect("version-filter", versionSet);
      fillSelect("loader-filter", loaderSet);
      fillSelect("author-filter", authorSet);
    }

    function fillSelect(id, values) {
      const select = document.getElementById(id);
      [...values].sort().forEach(v=>{
        const opt=document.createElement("option");
        opt.value=v.toLowerCase();
        opt.textContent=v;
        select.appendChild(opt);
      });
    }

    function filterMods() {
      const search = document.getElementById("search").value.toLowerCase();
      const ver = document.getElementById("version-filter").value;
      const loader = document.getElementById("loader-filter").value;
      const author = document.getElementById("author-filter").value;
      document.querySelectorAll(".mod-card").forEach(card=>{
        const matchName = card.dataset.name.includes(search);
        const matchVer = !ver || card.dataset.versions.toLowerCase().split(",").includes(ver);
        const matchLoader = !loader || card.dataset.loaders.toLowerCase().split(",").includes(loader);
        const matchAuthor = !author || card.dataset.authors.split(",").includes(author);
        card.classList.toggle("hidden", !(matchName && matchVer && matchLoader && matchAuthor));
      });
    }

    document.getElementById("search").addEventListener("input", filterMods);
    document.getElementById("version-filter").addEventListener("change", filterMods);
    document.getElementById("loader-filter").addEventListener("change", filterMods);
    document.getElementById("author-filter").addEventListener("change", filterMods);

    document.getElementById("theme-toggle").onclick = () => {
      document.body.classList.toggle("dark");
    };

    loadMods();
  </script>
</body>
</html>
